{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Chat{% endblock %}</h1>
{% endblock %}

{% block content %}
  <div id="chat-window" class="border rounded p-3 overflow-y-auto d-flex flex-column-reverse" style="max-height: 60vh;">

    <div>
      {% for chat in chats %}
        {% if g.user['id'] == chat['author_id'] %}
          <div class="d-flex justify-content-end mb-2">
            <div style="max-width: 75%;" class="text-end">
              <div class="p-2 rounded" style="background-color: {{ chat['color'] }}; color: #000; display: inline-block; text-align: left;">
                <p class="body m-0">{{ chat['body'] }}</p>
              </div>
              <div class="small text-body-secondary mt-1">
                {{ chat['created'].strftime('%Y-%m-%d %H:%M:%S') }}
              </div>
            </div>
          </div>
          {% else %}
          <div class="d-flex justify-content-start mb-2">
            <div style="max-width: 75%;">
              <div class="small text-body-secondary ms-1 mb-1">
                {{ chat['username'] }}
              </div>
              <div class="p-2 rounded" style="background-color:{{ chat['color'] }}; color: #000; display: inline-block; text-align: left;">
                <p class="body m-0">{{ chat['body'] }}</p>
              </div>
              <div class="small text-body-secondary mt-1 ms-1">
                {{ chat['created'].strftime('%Y-%m-%d %H:%M:%S') }}
              </div>
            </div>
          </div>
          {% endif %}

      {% else %}
        <div class="text-center text-body-secondary">
          <p>No messages yet.</p>
        </div>
      {% endfor %}
    </div>
  </div>

  <form method="post" action="{{ url_for('pages.create') }}" class="mt-4">
    <div class="input-group">
      <input type="text" name="body" class="form-control" placeholder="Type your message..." aria-label="Type your message" required>
      <button class="btn btn-primary" type="submit">Send</button>
    </div>
    </form>

{% endblock %}